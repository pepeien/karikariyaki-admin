<main>
	<div class="view__registry__header">
		<h1>{{ languageSource['PRODUCT_VIEW_TITLE'] }}</h1>
		<button (click)="onCreationInit()">
			<mat-icon>add</mat-icon>
			<span>{{ languageSource['PRODUCT_NEW_TITLE'] }}</span>
		</button>
	</div>
	<div class="view__registry__content">
		<div class="view__registry__content__editor" [attr.data-is-visible]="isEditorOpen">
			<div *ngIf="isEditorOpen && editorType === 'creation'" [@fade]>
				<h3>{{ languageSource['REGISTRY_EDITOR_CREATION_TITLE'] }}</h3>
				<form [formGroup]="creationFormGroup">
					<mat-form-field appearance="outline">
						<mat-label>{{ languageSource['REGISTRY_PRODUCT_NAME_INPUT'] }}</mat-label>
						<input matInput formControlName="name" required>
					</mat-form-field>
					<app-auto-complete
						*ngIf="canManageStands"
						[label]="languageSource['REGISTRY_PRODUCT_REALM_INPUT']"
						[data]="availableRealms"
						[formGroup]="creationFormGroup"
						[controlName]="'realm'"
						[optionGetter]="displayRealmAutocomplete"
						(onSelection)="onRealmSelection($event)"
					>
					</app-auto-complete>
					<div class="--ingredients">
						<h2> {{ languageSource['REGISTRY_PRODUCT_INGREDIENT_TITLE'] }}</h2>
						<div>
							<mat-form-field appearance="outline" class="--name">
								<mat-label>{{ languageSource['REGISTRY_PRODUCT_INGREDIENT_NAME_INPUT'] }}</mat-label>
								<input matInput formControlName="ingredientName">
							</mat-form-field>
							<div class="--type">
								<label id="igredient-type">{{ languageSource['REGISTRY_PRODUCT_INGREDIENT_TYPE_INPUT'] }}</label>
								<mat-radio-group
									aria-labelledby="igredient-type"
									[value]="selectedIngredientType"
									(change)="onIngredientTypeSelection($event)"
								>
									<mat-radio-button
										*ngFor="let ingredientType of availableIngredientTypes"
										color="warn"
										[value]="ingredientType"
									>
										{{ languageSource[ingredientType] }}
									</mat-radio-button>
								</mat-radio-group>
							</div>
						</div>
						<button (click)="onIngredientCreation()" [disabled]="isIgredientInvalid()">
							<mat-icon>add</mat-icon>
						</button>
						<ul class="ingredient__listing">
							<li *ngFor="let ingredient of ingredients" [@pop]>
								<div class="--data">
									<span>{{ languageSource['REGISTRY_PRODUCT_INGREDIENT_NAME_INPUT'] }}: {{ ingredient.data.name }}</span>
									<span>{{ languageSource['REGISTRY_PRODUCT_INGREDIENT_TYPE_INPUT'] }}: {{ languageSource[ingredient.data.type] }}</span>
								</div>
								<div class="--actions">
									<button class="--delete" (click)="onIngredientRemove(ingredient.id)">
										<mat-icon>delete</mat-icon>
									</button>
								</div>
							</li>
						</ul>
					</div>
				</form>
			</div>
			<div *ngIf="isEditorOpen && editorType === 'edition'" [@fade]>
				<h3>{{ languageSource['REGISTRY_EDITOR_EDITION_TITLE'] }}</h3>
				<form [formGroup]="editionFormGroup">
					<mat-form-field appearance="outline">
						<mat-label>{{ languageSource['REGISTRY_PRODUCT_NAME_INPUT'] }}</mat-label>
						<input matInput formControlName="name" required>
					</mat-form-field>
					<div class="--ingredients">
						<h2> {{ languageSource['REGISTRY_PRODUCT_INGREDIENT_TITLE'] }}</h2>
						<div>
							<mat-form-field appearance="outline" class="--name">
								<mat-label>{{ languageSource['REGISTRY_PRODUCT_INGREDIENT_NAME_INPUT'] }}</mat-label>
								<input matInput formControlName="ingredientName">
							</mat-form-field>
							<div class="--type">
								<label id="igredient-type">{{ languageSource['REGISTRY_PRODUCT_INGREDIENT_TYPE_INPUT'] }}</label>
								<mat-radio-group
									aria-labelledby="igredient-type"
									[value]="selectedIngredientType"
									(change)="onIngredientTypeSelection($event)"
								>
									<mat-radio-button
										*ngFor="let ingredientType of availableIngredientTypes"
										color="warn"
										[value]="ingredientType"
									>
										{{ languageSource[ingredientType] }}
									</mat-radio-button>
								</mat-radio-group>
							</div>
						</div>
						<button (click)="onIngredientCreation()" [disabled]="isIgredientInvalid()">
							<mat-icon>add</mat-icon>
						</button>
						<ul class="ingredient__listing">
							<li *ngFor="let ingredient of ingredients" [@pop]>
								<div class="--data">
									<span>{{ languageSource['REGISTRY_PRODUCT_INGREDIENT_NAME_INPUT'] }}: {{ ingredient.data.name }}</span>
									<span>{{ languageSource['REGISTRY_PRODUCT_INGREDIENT_TYPE_INPUT'] }}: {{ languageSource[ingredient.data.type] }}</span>
								</div>
								<div class="--actions">
									<button class="--delete" (click)="onIngredientRemove(ingredient.id)">
										<mat-icon>delete</mat-icon>
									</button>
								</div>
							</li>
						</ul>
					</div>
				</form>
			</div>
			<ul>
				<li class="--confirm">
					<button
						(click)="editorType === 'creation' ? onCreation() : onEdition()"
						[disabled]="editorType === 'creation' ? isCreationInvalid() : isEditInvalid()"
					>
						{{ editorType === 'creation' ? languageSource['REGISTRY_EDITOR_CREATION_ACTION'] : languageSource['REGISTRY_EDITOR_EDITION_ACTION'] }}
					</button>
				</li>
				<li class="--cancel">
					<button (click)="onCancel()">{{ languageSource['REGISTRY_EDITOR_CANCEL_ACTION'] }}</button>
				</li>
			</ul>
		</div>
		<app-table
			[data]="dataList"
			[onEdit]="onEditionInit.bind(this)"
			[onDelete]="onDeleteInit.bind(this)"
		>
		</app-table>
	</div>
</main>